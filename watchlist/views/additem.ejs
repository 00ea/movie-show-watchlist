<%- contentFor('body') %>

<div class="d-flex justify-content-center align-items-center" style="min-height: 80vh;">
  <div class="card bg-dark p-4" style="max-width: 52rem; width: 100%;">
    <div class="card-body d-flex flex-column align-items-center p-4">

      <!-- Title -->
      <h1 class="card-title py-3" style="text-align: center; font-size: 2.25rem; animation: fadeInDown 0.8s ease-out;" id="pageTitle">
        Add New Item <i class="fa-solid fa-film"></i>
      </h1>

      <form action="/additem" method="POST" id="addItemForm">
      
         <!-- Type Selection -->
            <div class="row mb-3 justify-content-center" style="animation: fadeInDown 0.8s ease-out;">
              <div class="col-md-6">
              <label for="type" class="form-label text-center d-block">Type <span class="text-danger">*</span></label>
              <select class="form-control" id="type" name="type" required>
                <option value="">-- Select Type --</option>
                <option value="movie">Movie</option>
                <option value="show">TV Show</option>
              </select>
            </div>
            </div>
            
            <!-- Title -->
            <div class="row mb-3">
              <div class="col-md-6" style="animation: fadeInLeft 0.8s ease-out;">
              <label for="title" class="form-label">Title <span class="text-danger">*</span></label>
              <input 
                type="text" 
                class="form-control" 
                id="title" 
                name="title" 
                placeholder="Enter title"
                required
                value="<%= locals.formData ? formData.title : '' %>">
            </div>

           <!-- Director -->
            <div class="col-md-6" style="animation: fadeInRight 0.8s ease-out;">
              <label for="director" class="form-label">Director</label>
              <input 
                type="text" 
                class="form-control" 
                id="director" 
                name="director" 
                placeholder="Enter director or creator name"
                value="<%= locals.formData ? formData.director : '' %>"
              >
            </div>
            </div>

            <!-- Duration -->
            <div class="row mb-3">
              <div class="col-md-6" style="animation: fadeInLeft 0.8s ease-out;">
              <label for="duration" class="form-label">Duration</label>
              <input 
                type="text" 
                class="form-control" 
                id="duration" 
                name="duration" 
                placeholder="e.g., 2h 30m or 45 min/episode"
                value="<%= locals.formData ? formData.duration : '' %>"
              >
            </div>

             <!-- Genre -->
            <div class="col-md-6" style="animation: fadeInRight 0.8s ease-out;">
              <label for="genre" class="form-label">Genre(s) <span class="text-danger">*</span></label>
              <input 
                type="text" 
                class="form-control" 
                id="genre" 
                name="genre" 
                placeholder="Action, Drama, Sci-Fi (comma-separated)"
                required
                value="<%= locals.formData ? formData.genre : '' %>"
              >
              <small class="form-text text-muted">Separate multiple genres with commas</small>
            </div>
            </div>

            <!-- imdb Ratings -->
            <div class="row mb-3">
              <div class="col-md-6" style="animation: fadeInLeft 0.8s ease-out;">
                <label for="imdbRating" class="form-label">IMDb Rating</label>
                <input 
                  type="number" 
                  class="form-control" 
                  id="imdbRating" 
                  name="imdbRating" 
                  min="0" 
                  max="10" 
                  step="0.1"
                  placeholder="0.0 - 10.0"
                  value="<%= locals.formData ? formData.imdbRating : '' %>"
                >
              </div>
              
               <!-- Release Year -->
            <div class="col-md-6" style="animation: fadeInRight 0.8s ease-out;">
              <label for="releaseYear" class="form-label">Release Year <span class="text-danger">*</span></label>
              <input 
                type="number" 
                class="form-control" 
                id="releaseYear" 
                name="releaseYear" 
                min="1888" 
                max="<%= new Date().getFullYear() + 5 %>"
                placeholder="<%= new Date().getFullYear() %>"
                required
                value="<%= locals.formData ? formData.releaseYear : '' %>"
              >
            </div>
            </div>

            <!-- Status -->
            <div class="row mb-3 justify-content-center">
              <div class="col-md-6" style="animation: fadeInUp 1s ease-out;">
              <label for="status" class="form-label text-center d-block">Status</label>
              <select class="form-control" id="status" name="status">
                <option value="Not Started">Not Started</option>
                <option value="In Progress">In Progress</option>
                <option value="Completed">Completed</option>
              </select>
            </div>
            </div>

            <!-- Show-Specific Fields (Hidden by default) -->
            <div id="showFields" style="display: none;" style="animation: fadeInUp 1s ease-out;">
              <hr class="my-4">
              <h5 class="mb-3">TV Show Details</h5>
              
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="totalSeasons" class="form-label">Total Seasons</label>
                  <input 
                    type="number" 
                    class="form-control" 
                    id="totalSeasons" 
                    name="totalSeasons" 
                    min="1"
                    placeholder="e.g., 5"
                  >
                </div>
                <div class="col-md-6">
                  <label for="totalEpisodes" class="form-label">Total Episodes</label>
                  <input 
                    type="number" 
                    class="form-control" 
                    id="totalEpisodes" 
                    name="totalEpisodes" 
                    min="1"
                    placeholder="e.g., 60"
                  >
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="currentSeason" class="form-label">Current Season</label>
                  <input 
                    type="number" 
                    class="form-control" 
                    id="currentSeason" 
                    name="currentSeason" 
                    min="1"
                    placeholder="1"
                  >
                </div>
                <div class="col-md-6">
                  <label for="currentEpisode" class="form-label">Current Episode</label>
                  <input 
                    type="number" 
                    class="form-control" 
                    id="currentEpisode" 
                    name="currentEpisode" 
                    min="0"
                    placeholder="0"
                  >
                </div>
              </div>
            </div>

            <!-- Submit Buttons -->
            <div class="d-flex gap-3 mt-4 justify-content-center" style="animation: fadeInUp 1s ease-out;">
              <a href="/catalog" class="btn btn-danger btn-lg">
                Cancel
                <i class="fas fa-times ms-2"></i>
              </a>
              <button type="submit" class="btn btn-success btn-lg">
                Submit
                <i class="fa-solid fa-check ms-2"></i>
              </button>
            </div>

      </form>

    </div>
  </div>
</div>

<script>
  // Update page title and show/hide TV show fields based on type selection
  document.getElementById('type').addEventListener('change', function() {
    const showFields = document.getElementById('showFields');
    const showInputs = showFields.querySelectorAll('input');
    const pageTitle = document.getElementById('pageTitle');
    
    if (this.value === 'show') {
      // Change title to "Add New TV Show"
      pageTitle.innerHTML = 'Add New TV Show <i class="fa-solid fa-tv"></i>';
      showFields.style.display = 'block';

      // Make show fields required when visible
      showInputs.forEach(input => {
        if (input.id === 'totalSeasons' || input.id === 'totalEpisodes') {
          input.setAttribute('required', 'required');
        }
      });
    } else if (this.value === 'movie') {
      // Change title to "Add New Movie"
      pageTitle.innerHTML = 'Add New Movie <i class="fa-solid fa-film"></i>';
      showFields.style.display = 'none';

      // Remove required attribute when hidden
      showInputs.forEach(input => {
        input.removeAttribute('required');
        input.value = '';
      });
    } else {
      // Default title when nothing selected
      pageTitle.innerHTML = 'Add New Item <i class="fa-solid fa-film"></i>';
      showFields.style.display = 'none';

      // Remove required attribute when hidden
      showInputs.forEach(input => {
        input.removeAttribute('required');
        input.value = '';
      });
    }
  });
</script>
